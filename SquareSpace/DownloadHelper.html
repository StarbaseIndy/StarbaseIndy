<html>
  <head>
    <title>Squarespace Detailed Order Download Helper</title>
    <script>
      // Why download this way?  Because the SquareSpace Commerce API costs extra.
      // https://developers.squarespace.com/commerce-api

      function getUrl(productId) {
        return 'https://heather-cottingham-r34y.squarespace.com/api/commerce/orders/export' +
               '?orderStates=PENDING' +
               '&productType=' +
               '&includeProductForm=true' +
			   '&productId=' + productId;
      }
      
      function get2018Url(productId) {
        return getUrl(productId) +
               '&orderSubmittedOnMin=2018-04-20T00%3A00%3A00.000Z' +
               '&orderSubmittedOnMax=2018-11-23T00%3A00%3A00.000Z';
      }
      
      function onLoad() {
        // 2018
        document.getElementById('2018WeekendBadge').href = get2018Url('5a9af8dbec212db87d180a40');
        document.getElementById('2018StarBadge').href = get2018Url('5a9aff4a0d9297b12545dd96');
        document.getElementById('2018SaturdayBadge').href = get2018Url('5a9aff4a0d9297b12545dd96');
        document.getElementById('2018ChildrensBadge').href = get2018Url('5a9b05e5c830255b24337e84');
        document.getElementById('2018SundayBadge').href = get2018Url('5a9b05cc71c10b1a7d192bb4');
        document.getElementById('2018StudentBadge').href = get2018Url('5b43fe24aa4a9907985a6406');
        document.getElementById('2018ShoppingWristband').href = get2018Url('5a9b018af9619a44982d5255');

        // TODO: add next year href initialization here.
      }
    </script>
  </head>
  <body onload="onLoad()">
    <h1>Squarespace Detailed Order Download Helper</h1>
    <h3>Instructions:</h3>
    <ul>
      <li>Log into <a target="_blank" href="https://heather-cottingham-r34y.squarespace.com/">SBI SquareSpace</a> (will open in new tab)</li>
      <li>Right-click each link below, and select 'Save link as...'</li>
      <li>Rename the file before saving</li>
    </ul>
    <a href="#" id="2018WeekendBadge" download="WeekendBadge.csv">2018 Weekend Badge</a><br/>
    <a href="#" id="2018StarBadge" download="StarBadge.csv">2018 Star Badge</a><br/>
    <a href="#" id="2018SaturdayBadge" download="SaturdayBadge.csv">2018 Saturday Badge</a><br/>
    <a href="#" id="2018ChildrensBadge" download="ChildrensBadge.csv">2018 Children's Badge</a><br/>
    <a href="#" id="2018SundayBadge" download="SundayBadge.csv">2018 Sunday Badge</a><br/>
    <a href="#" id="2018StudentBadge" download="StudentBadge.csv">2018 Student Badge</a><br/>
    <a href="#" id="2018ShoppingWristband" download="ShoppingWristband.csv">2018 Shopping Wristband</a><br/>
  </body>
</html>

